name: ðŸ§ª Test Self-Hosted Runner

on:
  workflow_dispatch:    # manual trigger in GitHub Actions UI
  push:
    branches: [ main ]

jobs:
  self_hosted_test:
    name: Verify Runner Setup
    runs-on: self-hosted   # must match the label on your runner (default = self-hosted)
    steps:
      - name: ðŸ§© Show runner info
        run: |
          echo "âœ… Runner is online!"
          echo "User: $(whoami)"
          echo "Host: $(hostname)"
          echo "OS: $(cat /etc/os-release | grep PRETTY_NAME)"
          echo "Work dir: $PWD"
          echo "Labels: ${{ runner.labels }}"

      - name: ðŸ§  Check basic tooling
        run: |
          echo "Git version:"
          git --version
          echo "Docker version:"
          docker --version || echo "Docker not installed"
          echo "Ansible version:"
          ansible --version || echo "Ansible not installed"

      - name: ðŸ§° Verify network access
        run: |
          curl -s -o /dev/null -w "%{http_code}\n" https://api.github.com
          ping -c 2 github.com || true

      - name: âœ… Success message
        run: echo "ðŸŽ‰ Self-hosted runner is working properly!"
